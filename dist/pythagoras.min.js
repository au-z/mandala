"use strict";var Pythagoras=function(){function r(r){return r.map(function(r){r.css=null,r.plan=null,r.tree={},r.html="{0}",r.uri&&t(r.uri,"json").then(function(t){e(r,t)}).then(function(t){n(r)}),r.styleUri&&t(r.styleUri,"text").then(function(t){r.css=t})}),r}function t(r,t){return new Promise(function(e,n){var i=new XMLHttpRequest;i.responseType=t,i.open("GET",r),i.onload=function(){200===i.status&&null!==i.response?e(i.response):n(Error(i.statusText))},i.onerror=function(){n(Error("Network error."))},i.send()})}function e(r,t){r.plan=t,r.tree.L0=i(r,r.tree.L0,t.design.L0,"L0",!0)}function n(r){o(r,{node:r.tree.L0,id:0}),r.html=r.html.replace("{0}","")}function i(r,t,e,n){var o=!(arguments.length<=4||void 0===arguments[4])&&arguments[4],a=e.shape,s=r.plan.shapes[a],l=e.particles,d=r.plan.particles[l];if(!a)throw new Error("Could not find shape key in provided effect design.");if(!s)throw new Error("Could not find shape value in provided effect design.");if(!l)throw new Error("Could not find particle key in provided effect design.");if(!d)throw new Error("Could not find particle value in provided effect design.");t={shape:a,attrs:[n,"shape",o?"root":null].concat(s.attrs),particles:[]};for(var c=0;c<s.particleCount;c++)t.particles.push({type:l,attrs:[n],child:null}),t.particles[c].attrs.push(r.plan.particleIterators[c]),t.particles[c].attrs=t.particles[c].attrs.concat(d.attrs),e.link&&e.link!==e&&(t.particles[c].child=i(r,t.particles[c].child,r.plan.design[e.link],e.link));return t}function o(r,t){var e=a.format(t.id++,t.node.attrs.join(" "),t.node.particles?"{0}</div>":"</div>{0}");if(r.html=r.html.format(e),t.node.particles){for(var n=0;n<t.node.particles.length;n++){var i=s.format(t.id++,t.node.particles[n].attrs.join(" "),t.node.particles[n].child?"{0}</div>":"</div>{0}");r.html=r.html.format(i),t.node.particles[n].child&&(t.id=o(r,{node:t.node.particles[n].child,id:t.id}))}r.html=r.html.replace("{0}</div>","</div></div>{0}")}return t.id}var a='<div id="el-{0}" class="{1}">{2}',s='<div id="el-{0}" class="{1}">{2}';if("undefined"==typeof Promise&&Promise.toString().indexOf("[native code]")==-1)throw new Error("Sorry, promises are not supported by your browser. :( Try another browser.");return String.prototype.format||(String.prototype.format=function(){var r=arguments;return this.replace(/{(\d+)}/g,function(t,e){return"undefined"!=typeof r[e]?r[e]:t})}),{load:r}};