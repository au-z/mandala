var Pythagoras=function(){function e(e){return e.map(function(e){e.css=null,e.plan=null,e.tree={},e.html="{0}",e.uri&&r(e.uri,"json").then(function(r){t(e,r)}).then(function(r){n(e)}),e.styleUri&&r(e.styleUri,"text").then(function(r){e.css=r})}),e}function r(e,r){return new Promise(function(t,n){var i=new XMLHttpRequest;i.responseType=r,i.open("GET",e),i.onload=function(){200===i.status&&null!==i.response?t(i.response):n(Error(i.statusText))},i.onerror=function(){n(Error("Network error."))},i.send()})}function t(e,r){e.plan=r,e.tree.L0=i(e,e.tree.L0,r.design.L0,"L0",!0)}function n(e){o(e,{node:e.tree.L0,id:0}),e.html=e.html.replace("{0}","")}function i(e,r,t,n,o){o=o||!1;var s=t.shape,a=e.plan.shapes[s],l=t.particles,d=e.plan.particles[l];if(!s)throw new Error("Could not find shape key in provided effect design.");if(!a)throw new Error("Could not find shape value in provided effect design.");if(!l)throw new Error("Could not find particle key in provided effect design.");if(!d)throw new Error("Could not find particle value in provided effect design.");r={shape:s,classes:[n,"shape",o?"root":null].concat(a.classes),args:a.args,particles:[]};for(var c=0;c<a.particleCount;c++)r.particles.push({type:l,classes:["vert",n],args:d.args,child:null}),r.particles[c].classes=r.particles[c].classes.concat(d.classes),t.link&&t.link!==t&&(r.particles[c].child=i(e,r.particles[c].child,e.plan.design[t.link],t.link));return r}function o(e,r,t){var n=s(r.node,t||0),i=l.format(r.id++,r.node.classes.join(" "),n,r.node.particles?"{0}</div>":"</div>{0}");if(e.html=e.html.format(i),r.node.particles){for(var d=0;d<r.node.particles.length;d++){var p=a(r.node,r.node.particles[d],d,r.node.particles.length),u=c.format(r.id++,r.node.particles[d].classes.join(" "),p,r.node.particles[d].child?"{0}</div>":"</div>{0}");e.html=e.html.format(u),r.node.particles[d].child&&(r.id=o(e,{node:r.node.particles[d].child,id:r.id},r.node.particles[d].args.radius))}e.html=e.html.replace("{0}</div>","</div></div>{0}")}return r.id}function s(e,r){var t=e.args.radius,n=2*t,i=-1*(t-r);return d.format(n,n,n,i,i)}function a(e,r,t,n){var i=e.args.radius,o=r.args.radius,s=2*o,a=2*Math.PI/n,l=i*Math.sin(t*a)+i-o,d=i*Math.cos(t*a)+i-o;return p.format(l,d,s,s,s)}var l='<div id="el-{0}" class="{1}" style="{2}">{3}',d="width: {0}px; height: {1}px; border-radius: {2}px; margin-left: {3}px; margin-top: {4}px",c='<div id="el-{0}" class="{1}" style="{2}">{3}',p="left: {0}px; bottom: {1}px; width: {2}px; height: {3}px; border-radius: {4}px;";if("undefined"==typeof Promise&&Promise.toString().indexOf("[native code]")==-1)throw new Error("Sorry, promises are not supported by your browser. :( Try another browser.");return String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(r,t){return"undefined"!=typeof e[t]?e[t]:r})}),{load:e}};